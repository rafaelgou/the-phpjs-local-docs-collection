

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>collection Field Type &mdash; Symfony Docs 2.3 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="Symfony Docs 2.3 documentation" href="../../../index.html" />
    <link rel="up" title="Form Types Reference" href="../types.html" />
    <link rel="next" title="country Field Type" href="country.html" />
    <link rel="prev" title="choice Field Type" href="choice.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="country.html" title="country Field Type"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="choice.html" title="choice Field Type"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../index.html">Symfony Docs 2.3 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Reference Documents</a> &raquo;</li>
          <li><a href="../types.html" accesskey="U">Form Types Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="collection-field-type">
<span id="index-0"></span><h1>collection Field Type<a class="headerlink" href="#collection-field-type" title="Permalink to this headline">¶</a></h1>
<p>This field type is used to render a &#8220;collection&#8221; of some field or form. In
the easiest sense, it could be an array of <tt class="docutils literal"><span class="pre">text</span></tt> fields that populate
an array <tt class="docutils literal"><span class="pre">emails</span></tt> field. In more complex examples, you can embed entire
forms, which is useful when creating forms that expose one-to-many relationships
(e.g. a product from where you can manage many related product photos).</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Rendered as</td>
<td>depends on the <a class="reference internal" href="#type">type</a> option</td>
</tr>
<tr class="row-even"><td>Options</td>
<td><ul class="first last simple">
<li><a class="reference internal" href="#type">type</a></li>
<li><a class="reference internal" href="#options">options</a></li>
<li><a class="reference internal" href="#allow-add">allow_add</a></li>
<li><a class="reference internal" href="#allow-delete">allow_delete</a></li>
<li><a class="reference internal" href="#prototype">prototype</a></li>
<li><a class="reference internal" href="#prototype-name">prototype_name</a></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Inherited
options</td>
<td><ul class="first last simple">
<li><a class="reference internal" href="#label">label</a></li>
<li><a class="reference internal" href="#error-bubbling">error_bubbling</a></li>
<li><a class="reference internal" href="#error-mapping">error_mapping</a></li>
<li><a class="reference internal" href="#by-reference">by_reference</a></li>
<li><a class="reference internal" href="#empty-data">empty_data</a></li>
<li><a class="reference internal" href="#mapped">mapped</a></li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Parent type</td>
<td><a class="reference internal" href="form.html"><em>form</em></a></td>
</tr>
<tr class="row-odd"><td>Class</td>
<td><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Extension/Core/Type/CollectionType.html" title="Symfony\Component\Form\Extension\Core\Type\CollectionType"><span class="pre">CollectionType</span></a></tt></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are working with a collection of Doctrine entities, pay special
attention to the <a class="reference internal" href="#allow-add">allow_add</a>, <a class="reference internal" href="#allow-delete">allow_delete</a> and <a class="reference internal" href="#by-reference">by_reference</a> options.
You can also see a complete example in the cookbook article
<a class="reference internal" href="../../../cookbook/form/form_collections.html"><em>How to Embed a Collection of Forms</em></a>.</p>
</div>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>This type is used when you want to manage a collection of similar items in
a form. For example, suppose you have an <tt class="docutils literal"><span class="pre">emails</span></tt> field that corresponds
to an array of email addresses. In the form, you want to expose each email
address as its own input text box:</p>
<div class="highlight-python"><pre>$builder-&gt;add('emails', 'collection', array(
    // each item in the array will be an "email" field
    'type'   =&gt; 'email',
    // these options are passed to each "email" type
    'options'  =&gt; array(
        'required'  =&gt; false,
        'attr'      =&gt; array('class' =&gt; 'email-box')
    ),
));</pre>
</div>
<p>The simplest way to render this is all at once:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_row</span><span class="o">(</span><span class="nv">form.emails</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">row</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;emails&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>A much more flexible method would look like this:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_label</span><span class="o">(</span><span class="nv">form.emails</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">form.emails</span><span class="o">)</span> <span class="cp">}}</span>

<span class="nt">&lt;ul&gt;</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">emailField</span> <span class="k">in</span> <span class="nv">form.emails</span> <span class="cp">%}</span>
    <span class="nt">&lt;li&gt;</span>
        <span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">emailField</span><span class="o">)</span> <span class="cp">}}</span>
        <span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">emailField</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="nt">&lt;/li&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">label</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;emails&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;emails&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span>

<span class="nt">&lt;ul&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;emails&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$emailField</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span>
    <span class="nt">&lt;li&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="nv">$emailField</span><span class="p">)</span> <span class="cp">?&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">widget</span><span class="p">(</span><span class="nv">$emailField</span><span class="p">)</span> <span class="cp">?&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>In both cases, no input fields would render unless your <tt class="docutils literal"><span class="pre">emails</span></tt> data array
already contained some emails.</p>
<p>In this simple example, it&#8217;s still impossible to add new addresses or remove
existing addresses. Adding new addresses is possible by using the <a class="reference internal" href="#allow-add">allow_add</a>
option (and optionally the <a class="reference internal" href="#prototype">prototype</a> option) (see example below). Removing
emails from the <tt class="docutils literal"><span class="pre">emails</span></tt> array is possible with the <a class="reference internal" href="#allow-delete">allow_delete</a> option.</p>
<div class="section" id="adding-and-removing-items">
<h3>Adding and Removing items<a class="headerlink" href="#adding-and-removing-items" title="Permalink to this headline">¶</a></h3>
<p>If <a class="reference internal" href="#allow-add">allow_add</a> is set to <tt class="docutils literal"><span class="pre">true</span></tt>, then if any unrecognized items are submitted,
they&#8217;ll be added seamlessly to the array of items. This is great in theory,
but takes a little bit more effort in practice to get the client-side JavaScript
correct.</p>
<p>Following along with the previous example, suppose you start with two
emails in the <tt class="docutils literal"><span class="pre">emails</span></tt> data array. In that case, two input fields will
be rendered that will look something like this (depending on the name of
your form):</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;email&quot;</span> <span class="na">id=</span><span class="s">&quot;form_emails_0&quot;</span> <span class="na">name=</span><span class="s">&quot;form[emails][0]&quot;</span> <span class="na">value=</span><span class="s">&quot;foo@foo.com&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;email&quot;</span> <span class="na">id=</span><span class="s">&quot;form_emails_1&quot;</span> <span class="na">name=</span><span class="s">&quot;form[emails][1]&quot;</span> <span class="na">value=</span><span class="s">&quot;bar@bar.com&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>To allow your user to add another email, just set <a class="reference internal" href="#allow-add">allow_add</a> to <tt class="docutils literal"><span class="pre">true</span></tt>
and - via JavaScript - render another field with the name <tt class="docutils literal"><span class="pre">form[emails][2]</span></tt>
(and so on for more and more fields).</p>
<p>To help make this easier, setting the <a class="reference internal" href="#prototype">prototype</a> option to <tt class="docutils literal"><span class="pre">true</span></tt> allows
you to render a &#8220;template&#8221; field, which you can then use in your JavaScript
to help you dynamically create these new fields. A rendered prototype field
will look like this:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;email&quot;</span> <span class="na">id=</span><span class="s">&quot;form_emails___name__&quot;</span> <span class="na">name=</span><span class="s">&quot;form[emails][__name__]&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>By replacing <tt class="docutils literal"><span class="pre">__name__</span></tt> with some unique value (e.g. <tt class="docutils literal"><span class="pre">2</span></tt>),
you can build and insert new HTML fields into your form.</p>
<p>Using jQuery, a simple example might look like this. If you&#8217;re rendering
your collection fields all at once (e.g. <tt class="docutils literal"><span class="pre">form_row(form.emails)</span></tt>), then
things are even easier because the <tt class="docutils literal"><span class="pre">data-prototype</span></tt> attribute is rendered
automatically for you (with a slight difference - see note below) and all
you need is the JavaScript:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_start</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="c">{# ... #}</span>

    <span class="c">{# store the prototype on the data-prototype attribute #}</span>
    <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;email-fields-list&quot;</span> <span class="na">data-prototype=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">form.emails.vars.prototype</span><span class="o">)</span> <span class="o">|</span> <span class="nf">e</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">emailField</span> <span class="k">in</span> <span class="nv">form.emails</span> <span class="cp">%}</span>
        <span class="nt">&lt;li&gt;</span>
            <span class="cp">{{</span> <span class="nv">form_errors</span><span class="o">(</span><span class="nv">emailField</span><span class="o">)</span> <span class="cp">}}</span>
            <span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">emailField</span><span class="o">)</span> <span class="cp">}}</span>
        <span class="nt">&lt;/li&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
    <span class="nt">&lt;/ul&gt;</span>

    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span> <span class="na">id=</span><span class="s">&quot;add-another-email&quot;</span><span class="nt">&gt;</span>Add another email<span class="nt">&lt;/a&gt;</span>

    <span class="c">{# ... #}</span>
<span class="cp">{{</span> <span class="nv">form_end</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>

<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
    <span class="c1">// keep track of how many email fields have been rendered</span>
    <span class="kd">var</span> <span class="nx">emailCount</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="cp">{{</span> <span class="nv">form.emails</span> <span class="o">|</span> <span class="nf">length</span> <span class="cp">}}</span><span class="s1">&#39;</span><span class="p">;</span>

    <span class="nx">jQuery</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#add-another-email&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">emailList</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#email-fields-list&#39;</span><span class="p">);</span>

            <span class="c1">// grab the prototype template</span>
            <span class="kd">var</span> <span class="nx">newWidget</span> <span class="o">=</span> <span class="nx">emailList</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-prototype&#39;</span><span class="p">);</span>
            <span class="c1">// replace the &quot;__name__&quot; used in the id and name of the prototype</span>
            <span class="c1">// with a number that&#39;s unique to your emails</span>
            <span class="c1">// end name attribute looks like name=&quot;contact[emails][2]&quot;</span>
            <span class="nx">newWidget</span> <span class="o">=</span> <span class="nx">newWidget</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/__name__/g</span><span class="p">,</span> <span class="nx">emailCount</span><span class="p">);</span>
            <span class="nx">emailCount</span><span class="o">++</span><span class="p">;</span>

            <span class="c1">// create a new list element and add it to the list</span>
            <span class="kd">var</span> <span class="nx">newLi</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;&lt;li&gt;&lt;/li&gt;&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">newWidget</span><span class="p">);</span>
            <span class="nx">newLi</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#email-fields-list&#39;</span><span class="p">));</span>

            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">})</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If you&#8217;re rendering the entire collection at once, then the prototype
is automatically available on the <tt class="docutils literal"><span class="pre">data-prototype</span></tt> attribute of the
element (e.g. <tt class="docutils literal"><span class="pre">div</span></tt> or <tt class="docutils literal"><span class="pre">table</span></tt>) that surrounds your collection. The
only difference is that the entire &#8220;form row&#8221; is rendered for you, meaning
you wouldn&#8217;t have to wrap it in any container element as was done
above.</p>
</div>
</div>
</div>
<div class="section" id="field-options">
<h2>Field Options<a class="headerlink" href="#field-options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="type">
<h3>type<a class="headerlink" href="#type" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">string</span></tt> or <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormTypeInterface.html" title="Symfony\Component\Form\FormTypeInterface"><span class="pre">FormTypeInterface</span></a></tt> <strong>required</strong></p>
<p>This is the field type for each item in this collection (e.g. <tt class="docutils literal"><span class="pre">text</span></tt>, <tt class="docutils literal"><span class="pre">choice</span></tt>,
etc). For example, if you have an array of email addresses, you&#8217;d use the
<a class="reference internal" href="email.html"><em>email</em></a> type. If you want to embed
a collection of some other form, create a new instance of your form type
and pass it as this option.</p>
</div>
<div class="section" id="options">
<h3>options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">array</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">array()</span></tt></p>
<p>This is the array that&#8217;s passed to the form type specified in the <a class="reference internal" href="#type">type</a>
option. For example, if you used the <a class="reference internal" href="choice.html"><em>choice</em></a>
type as your <a class="reference internal" href="#type">type</a> option (e.g. for a collection of drop-down menus), then
you&#8217;d need to at least pass the <tt class="docutils literal"><span class="pre">choices</span></tt> option to the underlying type:</p>
<div class="highlight-python"><pre>$builder-&gt;add('favorite_cities', 'collection', array(
    'type'   =&gt; 'choice',
    'options'  =&gt; array(
        'choices'  =&gt; array(
            'nashville' =&gt; 'Nashville',
            'paris'     =&gt; 'Paris',
            'berlin'    =&gt; 'Berlin',
            'london'    =&gt; 'London',
        ),
    ),
));</pre>
</div>
</div>
<div class="section" id="allow-add">
<h3>allow_add<a class="headerlink" href="#allow-add" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">Boolean</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">false</span></tt></p>
<p>If set to <tt class="docutils literal"><span class="pre">true</span></tt>, then if unrecognized items are submitted to the collection,
they will be added as new items. The ending array will contain the existing
items as well as the new item that was in the submitted data. See the above
example for more details.</p>
<p>The <a class="reference internal" href="#prototype">prototype</a> option can be used to help render a prototype item that
can be used - with JavaScript - to create new form items dynamically on the
client side. For more information, see the above example and <a class="reference internal" href="../../../cookbook/form/form_collections.html#cookbook-form-collections-new-prototype"><em>Allowing &#8220;new&#8221; tags with the &#8220;prototype&#8221;</em></a>.</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">If you&#8217;re embedding entire other forms to reflect a one-to-many database
relationship, you may need to manually ensure that the foreign key of
these new objects is set correctly. If you&#8217;re using Doctrine, this won&#8217;t
happen automatically. See the above link for more details.</p>
</div>
</div>
<div class="section" id="allow-delete">
<h3>allow_delete<a class="headerlink" href="#allow-delete" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">Boolean</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">false</span></tt></p>
<p>If set to <tt class="docutils literal"><span class="pre">true</span></tt>, then if an existing item is not contained in the submitted
data, it will be correctly absent from the final array of items. This means
that you can implement a &#8220;delete&#8221; button via JavaScript which simply removes
a form element from the DOM. When the user submits the form, its absence
from the submitted data will mean that it&#8217;s removed from the final array.</p>
<p>For more information, see <a class="reference internal" href="../../../cookbook/form/form_collections.html#cookbook-form-collections-remove"><em>Allowing tags to be removed</em></a>.</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">Be careful when using this option when you&#8217;re embedding a collection
of objects. In this case, if any embedded forms are removed, they <em>will</em>
correctly be missing from the final array of objects. However, depending on
your application logic, when one of those objects is removed, you may want
to delete it or at least remove its foreign key reference to the main object.
None of this is handled automatically. For more information, see
<a class="reference internal" href="../../../cookbook/form/form_collections.html#cookbook-form-collections-remove"><em>Allowing tags to be removed</em></a>.</p>
</div>
</div>
<div class="section" id="prototype">
<h3>prototype<a class="headerlink" href="#prototype" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">Boolean</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">true</span></tt></p>
<p>This option is useful when using the <a class="reference internal" href="#allow-add">allow_add</a> option. If <tt class="docutils literal"><span class="pre">true</span></tt> (and
if <a class="reference internal" href="#allow-add">allow_add</a> is also <tt class="docutils literal"><span class="pre">true</span></tt>), a special &#8220;prototype&#8221; attribute will be
available so that you can render a &#8220;template&#8221; example on your page of what
a new element should look like. The <tt class="docutils literal"><span class="pre">name</span></tt> attribute given to this element
is <tt class="docutils literal"><span class="pre">__name__</span></tt>. This allows you to add a &#8220;add another&#8221; button via JavaScript
which reads the prototype, replaces <tt class="docutils literal"><span class="pre">__name__</span></tt> with some unique name or
number, and render it inside your form. When submitted, it will be added
to your underlying array due to the <a class="reference internal" href="#allow-add">allow_add</a> option.</p>
<p>The prototype field can be rendered via the <tt class="docutils literal"><span class="pre">prototype</span></tt> variable in the
collection field:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_row</span><span class="o">(</span><span class="nv">form.emails.vars.prototype</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">row</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;emails&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">vars</span><span class="p">[</span><span class="s1">&#39;prototype&#39;</span><span class="p">])</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Note that all you really need is the &#8220;widget&#8221;, but depending on how you&#8217;re
rendering your form, having the entire &#8220;form row&#8221; may be easier for you.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If you&#8217;re rendering the entire collection field at once, then the prototype
form row is automatically available on the <tt class="docutils literal"><span class="pre">data-prototype</span></tt> attribute
of the element (e.g. <tt class="docutils literal"><span class="pre">div</span></tt> or <tt class="docutils literal"><span class="pre">table</span></tt>) that surrounds your collection.</p>
</div>
<p>For details on how to actually use this option, see the above example as well
as <a class="reference internal" href="../../../cookbook/form/form_collections.html#cookbook-form-collections-new-prototype"><em>Allowing &#8220;new&#8221; tags with the &#8220;prototype&#8221;</em></a>.</p>
</div>
<div class="section" id="prototype-name">
<h3>prototype_name<a class="headerlink" href="#prototype-name" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">String</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">__name__</span></tt></p>
<p>If you have several collections in your form, or worse, nested collections
you may want to change the placeholder so that unrelated placeholders are not
replaced with the same value.</p>
</div>
</div>
<div class="section" id="inherited-options">
<h2>Inherited options<a class="headerlink" href="#inherited-options" title="Permalink to this headline">¶</a></h2>
<p>These options inherit from the <a class="reference internal" href="form.html"><em>field</em></a> type.
Not all options are listed here - only the most applicable to this type:</p>
<div class="section" id="label">
<h3>label<a class="headerlink" href="#label" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">string</span></tt> <strong>default</strong>: The label is &#8220;guessed&#8221; from the field name</p>
<p>Sets the label that will be used when rendering the field. Setting to false
will suppress the label. The label can also be directly set inside the template:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">form_label</span><span class="o">(</span><span class="nv">form.name</span><span class="o">,</span> <span class="s1">&#39;Your name&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="mapped">
<h3>mapped<a class="headerlink" href="#mapped" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">boolean</span></tt></p>
<p>If you wish the field to be ignored when reading or writing to the object, you
can set the <tt class="docutils literal"><span class="pre">mapped</span></tt> option to <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
</div>
<div class="section" id="error-mapping">
<h3>error_mapping<a class="headerlink" href="#error-mapping" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">array</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">empty</span></tt></p>
<p>This option allows you to modify the target of a validation error.</p>
<p>Imagine you have a custom method named <tt class="docutils literal"><span class="pre">matchingCityAndZipCode</span></tt> that validates
whether the city and zip code match. Unfortunately, there is no &#8220;matchingCityAndZipCode&#8221;
field in your form, so all that Symfony can do is display the error on top
of the form.</p>
<p>With customized error mapping, you can do better: map the error to the city
field so that it displays above it:</p>
<div class="highlight-python"><pre>public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver-&gt;setDefaults(array(
        'error_mapping' =&gt; array(
            'matchingCityAndZipCode' =&gt; 'city',
        ),
    ));
}</pre>
</div>
<p>Here are the rules for the left and the right side of the mapping:</p>
<ul class="simple">
<li>The left side contains property paths.</li>
<li>If the violation is generated on a property or method of a class, its path
is simply &#8220;propertyName&#8221;.</li>
<li>If the violation is generated on an entry of an <tt class="docutils literal"><span class="pre">array</span></tt> or <tt class="docutils literal"><span class="pre">ArrayAccess</span></tt>
object, the property path is <tt class="docutils literal"><span class="pre">[indexName]</span></tt>.</li>
<li>You can construct nested property paths by concatenating them, separating
properties by dots. For example: <tt class="docutils literal"><span class="pre">addresses[work].matchingCityAndZipCode</span></tt></li>
<li>The left side of the error mapping also accepts a dot <tt class="docutils literal"><span class="pre">.</span></tt>, which refers
to the field itself. That means that any error added to the field is added
to the given nested field instead.</li>
<li>The right side contains simply the names of fields in the form.</li>
</ul>
</div>
<div class="section" id="error-bubbling">
<h3>error_bubbling<a class="headerlink" href="#error-bubbling" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">Boolean</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">true</span></tt></p>
<p>If true, any errors for this field will be passed to the parent field
or form. For example, if set to true on a normal field, any errors for
that field will be attached to the main form, not to the specific field.</p>
</div>
<div class="section" id="by-reference">
<span id="reference-form-types-by-reference"></span><h3>by_reference<a class="headerlink" href="#by-reference" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">Boolean</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">true</span></tt></p>
<p>In most cases, if you have a <tt class="docutils literal"><span class="pre">name</span></tt> field, then you expect <tt class="docutils literal"><span class="pre">setName</span></tt>
to be called on the underlying object. In some cases, however, <tt class="docutils literal"><span class="pre">setName</span></tt>
may <em>not</em> be called. Setting <tt class="docutils literal"><span class="pre">by_reference</span></tt> ensures that the setter is
called in all cases.</p>
<p>To explain this further, here&#8217;s a simple example:</p>
<div class="highlight-python"><pre>$builder = $this-&gt;createFormBuilder($article);
$builder
    -&gt;add('title', 'text')
    -&gt;add(
        $builder-&gt;create('author', 'form', array('by_reference' =&gt; ?))
            -&gt;add('name', 'text')
            -&gt;add('email', 'email')
    )</pre>
</div>
<p>If <tt class="docutils literal"><span class="pre">by_reference</span></tt> is true, the following takes place behind the scenes
when you call <tt class="docutils literal"><span class="pre">submit</span></tt> (or <tt class="docutils literal"><span class="pre">handleRequest</span></tt>) on the form:</p>
<div class="highlight-python"><pre>$article-&gt;setTitle('...');
$article-&gt;getAuthor()-&gt;setName('...');
$article-&gt;getAuthor()-&gt;setEmail('...');</pre>
</div>
<p>Notice that <tt class="docutils literal"><span class="pre">setAuthor</span></tt> is not called. The author is modified by reference.</p>
<p>If you set <tt class="docutils literal"><span class="pre">by_reference</span></tt> to false, submitting looks like this:</p>
<div class="highlight-python"><pre>$article-&gt;setTitle('...');
$author = $article-&gt;getAuthor();
$author-&gt;setName('...');
$author-&gt;setEmail('...');
$article-&gt;setAuthor($author);</pre>
</div>
<p>So, all that <tt class="docutils literal"><span class="pre">by_reference=false</span></tt> really does is force the framework to
call the setter on the parent object.</p>
<p>Similarly, if you&#8217;re using the <a class="reference internal" href=""><em>collection</em></a>
form type where your underlying collection data is an object (like with Doctrine&#8217;s
<tt class="docutils literal"><span class="pre">ArrayCollection</span></tt>), then <tt class="docutils literal"><span class="pre">by_reference</span></tt> must be set to <tt class="docutils literal"><span class="pre">false</span></tt> if you
need the setter (e.g. <tt class="docutils literal"><span class="pre">setAuthors</span></tt>) to be called.</p>
</div>
<div class="section" id="empty-data">
<h3>empty_data<a class="headerlink" href="#empty-data" title="Permalink to this headline">¶</a></h3>
<p><strong>type</strong>: <tt class="docutils literal"><span class="pre">mixed</span></tt> <strong>default</strong>: <tt class="docutils literal"><span class="pre">array()</span></tt> if <tt class="docutils literal"><span class="pre">multiple</span></tt> or <tt class="docutils literal"><span class="pre">expanded</span></tt>, <tt class="docutils literal"><span class="pre">''</span></tt> otherwise</p>
<p>This option determines what value the field will return when the <tt class="docutils literal"><span class="pre">empty_value</span></tt>
choice is selected.</p>
<p>The true default value of this option depends on the field options:</p>
<ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">compound</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt> and <tt class="docutils literal"><span class="pre">data_class</span></tt> is set, then <tt class="docutils literal"><span class="pre">new</span> <span class="pre">$data_class()</span></tt>;</li>
<li>If <tt class="docutils literal"><span class="pre">compound</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt> and no <tt class="docutils literal"><span class="pre">data_class</span></tt> is set, then <tt class="docutils literal"><span class="pre">array()</span></tt>;</li>
<li>If <tt class="docutils literal"><span class="pre">compound</span></tt> is <tt class="docutils literal"><span class="pre">false</span></tt>, then <tt class="docutils literal"><span class="pre">null</span></tt>.</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The <tt class="docutils literal"><span class="pre">compound</span></tt> option is set to <tt class="docutils literal"><span class="pre">true</span></tt> when the field actually represents
a collection of fields (e.g. a form of fields).</p>
</div>
<p>For example, if you want the <tt class="docutils literal"><span class="pre">gender</span></tt> field to be set to <tt class="docutils literal"><span class="pre">null</span></tt> when no
value is selected, you can do it like this:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;choice&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;choices&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;m&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span>
        <span class="s1">&#39;f&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Female&#39;</span>
    <span class="p">),</span>
    <span class="s1">&#39;required&#39;</span>    <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
    <span class="s1">&#39;empty_value&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Choose your gender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;empty_data&#39;</span>  <span class="o">=&gt;</span> <span class="k">null</span>
<span class="p">));</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to set the <tt class="docutils literal"><span class="pre">empty_data</span></tt> option for your entire form class,
see the cookbook article <a class="reference internal" href="../../../cookbook/form/use_empty_data.html"><em>How to configure Empty Data for a Form Class</em></a></p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">collection Field Type</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic Usage</a><ul>
<li><a class="reference internal" href="#adding-and-removing-items">Adding and Removing items</a></li>
</ul>
</li>
<li><a class="reference internal" href="#field-options">Field Options</a><ul>
<li><a class="reference internal" href="#type">type</a></li>
<li><a class="reference internal" href="#options">options</a></li>
<li><a class="reference internal" href="#allow-add">allow_add</a></li>
<li><a class="reference internal" href="#allow-delete">allow_delete</a></li>
<li><a class="reference internal" href="#prototype">prototype</a></li>
<li><a class="reference internal" href="#prototype-name">prototype_name</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inherited-options">Inherited options</a><ul>
<li><a class="reference internal" href="#label">label</a></li>
<li><a class="reference internal" href="#mapped">mapped</a></li>
<li><a class="reference internal" href="#error-mapping">error_mapping</a></li>
<li><a class="reference internal" href="#error-bubbling">error_bubbling</a></li>
<li><a class="reference internal" href="#by-reference">by_reference</a></li>
<li><a class="reference internal" href="#empty-data">empty_data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="choice.html"
                        title="previous chapter">choice Field Type</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="country.html"
                        title="next chapter">country Field Type</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/reference/forms/types/collection.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="country.html" title="country Field Type"
             >next</a> |</li>
        <li class="right" >
          <a href="choice.html" title="choice Field Type"
             >previous</a> |</li>
        <li><a href="../../../index.html">Symfony Docs 2.3 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Reference Documents</a> &raquo;</li>
          <li><a href="../types.html" >Form Types Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Symfony Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>