<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Kohana_Request_Client_Stream | Kohana User Guide</title>

<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok8v=02fcfa4f56/"},atok:"eee59e90a8282bcfc7cd8af99a42a3da",petok:"4b85d0b280a9f9ddf9a5f222d8f3c51dfa9dcfea-1394799437-1800",zone:"kohanaframework.org",rocket:"0",apps:{"ga_key":{"ua":"UA-27864271-1","ga_bs":"2"}}}];var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.async=!0;a.src="//ajax.cloudflare.com/cdn-cgi/nexp/dok8v=b064e16429/cloudflare.min.js";b.parentNode.insertBefore(a,b);}}catch(e){};
//]]>
</script>
<link type="text/css" href="../guide-media/css/print.css" rel="stylesheet" media="print" />
<link type="text/css" href="../guide-media/css/screen.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../guide-media/css/kodoc.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../guide-media/css/shCore.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../guide-media/css/shThemeKodoc.css" rel="stylesheet" media="screen" />

<script type="text/javascript" src="../guide-media/js/jquery.min.js"></script>
<script type="text/javascript" src="../guide-media/js/jquery.cookie.js"></script>
<script type="text/javascript" src="../guide-media/js/kodoc.js"></script>
<script type="text/javascript" src="../guide-media/js/shCore.js"></script>
<script type="text/javascript" src="../guide-media/js/shBrushPhp.js"></script>

<!--[if lt IE 9]>
<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
<![endif]-->
<script type="text/javascript">
/* <![CDATA[ */
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-27864271-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

(function(b){(function(a){"__CF"in b&&"DJS"in b.__CF?b.__CF.DJS.push(a):"addEventListener"in b?b.addEventListener("load",a,!1):b.attachEvent("onload",a)})(function(){"FB"in b&&"Event"in FB&&"subscribe"in FB.Event&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}));"twttr"in b&&"events"in twttr&&"bind"in twttr.events&&twttr.events.bind("tweet",function(a){if(a){var b;if(a.target&&a.target.nodeName=="IFRAME")a:{if(a=a.target.src){a=a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);b=0;for(var c;c=a[b];++b)if(c.indexOf("url")===0){b=unescape(c.split("=")[1]);break a}}b=void 0}_gaq.push(["_trackSocial","twitter","tweet",b])}})})})(window);
/* ]]> */
</script>
</head>
<body>

	<div id="kodoc-header">
		<div class="container">
			<a href="http://kohanaframework.org/" id="kodoc-logo">
				<img src="../guide-media/img/kohana.png" />
			</a>
			<div id="kodoc-menu">
				<ul>
					<li class="guide first">
						<a href="../guide.1.html">User Guide</a>
					</li>
										<li class="api">
						<a href="../guide-api.html">API Browser</a>
					</li>
									</ul>
			</div>
		</div>
	</div>

	<div id="kodoc-content">
		<div class="wrapper">
			<div class="container">
				<div class="span-22 prefix-1 suffix-1">
					<ul id="kodoc-breadcrumb">
																				<li><a href="../guide.1.html">User Guide</a></li>
																											<li><a href="../guide-api.html">API Browser</a></li>
																											<li class="last">Kohana_Request_Client_Stream</li>
																		</ul>
				</div>
				<div class="span-6 prefix-1">
					<div id="kodoc-topics">
						
<h2>Modules</h2>
<ol class="menu">
<li><span><strong>Kohana</strong></span>
	<ol>
			<li>							<li><a href="Debug.html">Debug</a></li>
							<li><a href="HTTP_Cache.html">HTTP_Cache</a></li>
							<li><a href="I18n.html">I18n</a></li>
							<li><a href="http://kohanaframework.org/3.3/guide-api/Kohana">Kohana</a></li>
							<li><a href="Kohana_Config_Writer.html">Kohana_Config_Writer</a></li>
							<li><a href="Request.html">Request</a></li>
							<li><a href="Request_Client.html">Request_Client</a></li>
							<li><a href="Request_Client_Curl.html">Request_Client_Curl</a></li>
							<li><a href="Request_Client_External.html">Request_Client_External</a></li>
							<li><a href="Request_Client_HTTP.html">Request_Client_HTTP</a></li>
							<li><a href="Request_Client_Internal.html">Request_Client_Internal</a></li>
							<li><a href="Request_Client_Stream.html">Request_Client_Stream</a></li>
							<li><a href="Response.html">Response</a></li>
							<li><a href="Route.html">Route</a></li>
							<li><a href="UTF8.html">UTF8</a></li>
							<li><a href="View.html">View</a></li>
								</li>
			<li><span>Configuration</span>
			<ol>							<li><a href="Config.html">Config</a></li>
							<li><a href="Config_File.html">Config_File</a></li>
							<li><a href="Config_Group.html">Config_Group</a></li>
							<li><a href="Kohana_Config_File_Reader.html">Kohana_Config_File_Reader</a></li>
							<li><a href="Kohana_Config_Reader.html">Kohana_Config_Reader</a></li>
							<li><a href="Kohana_Config_Source.html">Kohana_Config_Source</a></li>
						</ol>		</li>
			<li><span>Controller</span>
			<ol>							<li><a href="Controller.html">Controller</a></li>
							<li><a href="Controller_Template.html">Controller_Template</a></li>
							<li><a href="Controller_Welcome.html">Controller_Welcome</a></li>
						</ol>		</li>
			<li><span>Exceptions</span>
			<ol>							<li><a href="HTTP_Exception.html">HTTP_Exception</a></li>
							<li><a href="HTTP_Exception_300.html">HTTP_Exception_300</a></li>
							<li><a href="HTTP_Exception_301.html">HTTP_Exception_301</a></li>
							<li><a href="HTTP_Exception_302.html">HTTP_Exception_302</a></li>
							<li><a href="HTTP_Exception_303.html">HTTP_Exception_303</a></li>
							<li><a href="HTTP_Exception_304.html">HTTP_Exception_304</a></li>
							<li><a href="HTTP_Exception_305.html">HTTP_Exception_305</a></li>
							<li><a href="HTTP_Exception_307.html">HTTP_Exception_307</a></li>
							<li><a href="HTTP_Exception_400.html">HTTP_Exception_400</a></li>
							<li><a href="HTTP_Exception_401.html">HTTP_Exception_401</a></li>
							<li><a href="HTTP_Exception_402.html">HTTP_Exception_402</a></li>
							<li><a href="HTTP_Exception_403.html">HTTP_Exception_403</a></li>
							<li><a href="HTTP_Exception_404.html">HTTP_Exception_404</a></li>
							<li><a href="HTTP_Exception_405.html">HTTP_Exception_405</a></li>
							<li><a href="HTTP_Exception_406.html">HTTP_Exception_406</a></li>
							<li><a href="HTTP_Exception_407.html">HTTP_Exception_407</a></li>
							<li><a href="HTTP_Exception_408.html">HTTP_Exception_408</a></li>
							<li><a href="HTTP_Exception_409.html">HTTP_Exception_409</a></li>
							<li><a href="HTTP_Exception_410.html">HTTP_Exception_410</a></li>
							<li><a href="HTTP_Exception_411.html">HTTP_Exception_411</a></li>
							<li><a href="HTTP_Exception_412.html">HTTP_Exception_412</a></li>
							<li><a href="HTTP_Exception_413.html">HTTP_Exception_413</a></li>
							<li><a href="HTTP_Exception_414.html">HTTP_Exception_414</a></li>
							<li><a href="HTTP_Exception_415.html">HTTP_Exception_415</a></li>
							<li><a href="HTTP_Exception_416.html">HTTP_Exception_416</a></li>
							<li><a href="HTTP_Exception_417.html">HTTP_Exception_417</a></li>
							<li><a href="HTTP_Exception_500.html">HTTP_Exception_500</a></li>
							<li><a href="HTTP_Exception_501.html">HTTP_Exception_501</a></li>
							<li><a href="HTTP_Exception_502.html">HTTP_Exception_502</a></li>
							<li><a href="HTTP_Exception_503.html">HTTP_Exception_503</a></li>
							<li><a href="HTTP_Exception_504.html">HTTP_Exception_504</a></li>
							<li><a href="HTTP_Exception_505.html">HTTP_Exception_505</a></li>
							<li><a href="HTTP_Exception_Expected.html">HTTP_Exception_Expected</a></li>
							<li><a href="HTTP_Exception_Redirect.html">HTTP_Exception_Redirect</a></li>
							<li><a href="Kohana_Exception.html">Kohana_Exception</a></li>
							<li><a href="Request_Client_Recursion_Exception.html">Request_Client_Recursion_Exception</a></li>
							<li><a href="Request_Exception.html">Request_Exception</a></li>
							<li><a href="Session_Exception.html">Session_Exception</a></li>
							<li><a href="UTF8_Exception.html">UTF8_Exception</a></li>
							<li><a href="Validation_Exception.html">Validation_Exception</a></li>
							<li><a href="View_Exception.html">View_Exception</a></li>
						</ol>		</li>
			<li><span>HTTP</span>
			<ol>							<li><a href="HTTP.html">HTTP</a></li>
							<li><a href="HTTP_Header.html">HTTP_Header</a></li>
							<li><a href="HTTP_Message.html">HTTP_Message</a></li>
							<li><a href="HTTP_Request.html">HTTP_Request</a></li>
							<li><a href="HTTP_Response.html">HTTP_Response</a></li>
						</ol>		</li>
			<li><span>Helpers</span>
			<ol>							<li><a href="Arr.html">Arr</a></li>
							<li><a href="Cookie.html">Cookie</a></li>
							<li><a href="Date.html">Date</a></li>
							<li><a href="Feed.html">Feed</a></li>
							<li><a href="File.html">File</a></li>
							<li><a href="Form.html">Form</a></li>
							<li><a href="Fragment.html">Fragment</a></li>
							<li><a href="HTML.html">HTML</a></li>
							<li><a href="Inflector.html">Inflector</a></li>
							<li><a href="Num.html">Num</a></li>
							<li><a href="profiler.html">Profiler</a></li>
							<li><a href="Task_Help.html">Task_Help</a></li>
							<li><a href="Text.html">Text</a></li>
							<li><a href="URL.html">URL</a></li>
							<li><a href="Upload.html">Upload</a></li>
						</ol>		</li>
			<li><span>Logging</span>
			<ol>							<li><a href="Log.html">Log</a></li>
							<li><a href="Log_File.html">Log_File</a></li>
							<li><a href="Log_StdErr.html">Log_StdErr</a></li>
							<li><a href="Log_StdOut.html">Log_StdOut</a></li>
							<li><a href="Log_Syslog.html">Log_Syslog</a></li>
							<li><a href="Log_Writer.html">Log_Writer</a></li>
						</ol>		</li>
			<li><span>Minion</span>
			<ol>							<li><a href="Minion_Exception.html">Minion_Exception</a></li>
							<li><a href="Minion_Exception_InvalidTask.html">Minion_Exception_InvalidTask</a></li>
						</ol>		</li>
			<li><span>Models</span>
			<ol>							<li><a href="Model.html">Model</a></li>
						</ol>		</li>
			<li><span>Security</span>
			<ol>							<li><a href="Encrypt.html">Encrypt</a></li>
							<li><a href="Security.html">Security</a></li>
							<li><a href="Valid.html">Valid</a></li>
							<li><a href="Validation.html">Validation</a></li>
						</ol>		</li>
			<li><span>Session</span>
			<ol>							<li><a href="Session.html">Session</a></li>
							<li><a href="Session_Cookie.html">Session_Cookie</a></li>
							<li><a href="Session_Native.html">Session_Native</a></li>
						</ol>		</li>
		</ol>
<li><span><strong>Kohana/Auth</strong></span>
	<ol>
			<li>							<li><a href="Auth.html">Auth</a></li>
							<li><a href="Auth_File.html">Auth_File</a></li>
							<li><a href="Auth_ORM.html">Auth_ORM</a></li>
							<li><a href="Model_Auth_Role.html">Model_Auth_Role</a></li>
							<li><a href="Model_Auth_User.html">Model_Auth_User</a></li>
							<li><a href="Model_Auth_User_Token.html">Model_Auth_User_Token</a></li>
							<li><a href="Model_Role.html">Model_Role</a></li>
							<li><a href="Model_User.html">Model_User</a></li>
							<li><a href="Model_User_Token.html">Model_User_Token</a></li>
								</li>
		</ol>
<li><span><strong>Kohana/Cache</strong></span>
	<ol>
			<li>							<li><a href="Cache.html">Cache</a></li>
							<li><a href="Cache_Apc.html">Cache_Apc</a></li>
							<li><a href="Cache_Arithmetic.html">Cache_Arithmetic</a></li>
							<li><a href="Cache_Exception.html">Cache_Exception</a></li>
							<li><a href="Cache_File.html">Cache_File</a></li>
							<li><a href="Cache_GarbageCollect.html">Cache_GarbageCollect</a></li>
							<li><a href="Cache_Memcache.html">Cache_Memcache</a></li>
							<li><a href="Cache_MemcacheTag.html">Cache_MemcacheTag</a></li>
							<li><a href="Cache_Sqlite.html">Cache_Sqlite</a></li>
							<li><a href="Cache_Tagging.html">Cache_Tagging</a></li>
							<li><a href="Cache_Wincache.html">Cache_Wincache</a></li>
								</li>
		</ol>
<li><span><strong>Kohana/Codebench</strong></span>
	<ol>
			<li>							<li><a href="Codebench.html">Codebench</a></li>
								</li>
			<li><span>Controllers</span>
			<ol>							<li><a href="Controller_Codebench.html">Controller_Codebench</a></li>
						</ol>		</li>
			<li><span>Tests</span>
			<ol>							<li><a href="Bench_ArrCallback.html">Bench_ArrCallback</a></li>
							<li><a href="Bench_AutoLinkEmails.html">Bench_AutoLinkEmails</a></li>
							<li><a href="Bench_DateSpan.html">Bench_DateSpan</a></li>
							<li><a href="Bench_ExplodeLimit.html">Bench_ExplodeLimit</a></li>
							<li><a href="http://kohanaframework.org/3.3/guide-api/Bench_GruberURL">Bench_GruberURL</a></li>
							<li><a href="Bench_LtrimDigits.html">Bench_LtrimDigits</a></li>
							<li><a href="Bench_MDDoBaseURL.html">Bench_MDDoBaseURL</a></li>
							<li><a href="Bench_MDDoImageURL.html">Bench_MDDoImageURL</a></li>
							<li><a href="Bench_MDDoIncludeViews.html">Bench_MDDoIncludeViews</a></li>
							<li><a href="Bench_StripNullBytes.html">Bench_StripNullBytes</a></li>
							<li><a href="http://kohanaframework.org/3.3/guide-api/Bench_Transliterate">Bench_Transliterate</a></li>
							<li><a href="Bench_URLSite.html">Bench_URLSite</a></li>
							<li><a href="Bench_UserFuncArray.html">Bench_UserFuncArray</a></li>
							<li><a href="http://kohanaframework.org/3.3/guide-api/Bench_ValidColor">Bench_ValidColor</a></li>
							<li><a href="http://kohanaframework.org/3.3/guide-api/Bench_ValidURL">Bench_ValidURL</a></li>
						</ol>		</li>
		</ol>
<li><span><strong>Kohana/Database</strong></span>
	<ol>
			<li>							<li><a href="DB.html">DB</a></li>
							<li><a href="Database.html">Database</a></li>
							<li><a href="Database_Expression.html">Database_Expression</a></li>
								</li>
			<li><span>Configuration</span>
			<ol>							<li><a href="Config_Database.html">Config_Database</a></li>
							<li><a href="Config_Database_Reader.html">Config_Database_Reader</a></li>
							<li><a href="Config_Database_Writer.html">Config_Database_Writer</a></li>
						</ol>		</li>
			<li><span>Drivers</span>
			<ol>							<li><a href="Database_MySQL.html">Database_MySQL</a></li>
							<li><a href="Database_PDO.html">Database_PDO</a></li>
						</ol>		</li>
			<li><span>Exceptions</span>
			<ol>							<li><a href="Database_Exception.html">Database_Exception</a></li>
						</ol>		</li>
			<li><span>Models</span>
			<ol>							<li><a href="Model_Database.html">Model_Database</a></li>
						</ol>		</li>
			<li><span>Query</span>
			<ol>							<li><a href="Database_Query.html">Database_Query</a></li>
							<li><a href="Database_Query_Builder.html">Database_Query_Builder</a></li>
							<li><a href="Database_Query_Builder_Delete.html">Database_Query_Builder_Delete</a></li>
							<li><a href="Database_Query_Builder_Insert.html">Database_Query_Builder_Insert</a></li>
							<li><a href="Database_Query_Builder_Join.html">Database_Query_Builder_Join</a></li>
							<li><a href="Database_Query_Builder_Select.html">Database_Query_Builder_Select</a></li>
							<li><a href="Database_Query_Builder_Update.html">Database_Query_Builder_Update</a></li>
							<li><a href="Database_Query_Builder_Where.html">Database_Query_Builder_Where</a></li>
						</ol>		</li>
			<li><span>Query/Result</span>
			<ol>							<li><a href="Database_MySQL_Result.html">Database_MySQL_Result</a></li>
							<li><a href="Database_Result.html">Database_Result</a></li>
							<li><a href="Database_Result_Cached.html">Database_Result_Cached</a></li>
						</ol>		</li>
			<li><span>Session</span>
			<ol>							<li><a href="Session_Database.html">Session_Database</a></li>
						</ol>		</li>
		</ol>
<li><span><strong>Kohana/Image</strong></span>
	<ol>
			<li>							<li><a href="Image.html">Image</a></li>
								</li>
			<li><span>Drivers</span>
			<ol>							<li><a href="Image_GD.html">Image_GD</a></li>
							<li><a href="Image_Imagick.html">Image_Imagick</a></li>
						</ol>		</li>
		</ol>
<li><span><strong>Kohana/ORM</strong></span>
	<ol>
			<li>							<li><a href="ORM.html">ORM</a></li>
							<li><a href="ORM_Validation_Exception.html">ORM_Validation_Exception</a></li>
								</li>
		</ol>
<li><span><strong>Kohana/UnitTest</strong></span>
	<ol>
			<li>							<li><a href="Unittest_Database_TestCase.html">Unittest_Database_TestCase</a></li>
							<li><a href="Unittest_Tests.html">Unittest_Tests</a></li>
								</li>
		</ol>
<li><span><strong>Kohana/Userguide</strong></span>
	<ol>
			<li>							<li><a href="Kodoc.html">Kodoc</a></li>
							<li><a href="Kodoc_Class.html">Kodoc_Class</a></li>
							<li><a href="Kodoc_Markdown.html">Kodoc_Markdown</a></li>
							<li><a href="Kodoc_Method.html">Kodoc_Method</a></li>
							<li><a href="Kodoc_Method_Param.html">Kodoc_Method_Param</a></li>
							<li><a href="Kodoc_Property.html">Kodoc_Property</a></li>
								</li>
			<li><span>Controllers</span>
			<ol>							<li><a href="Controller_Userguide.html">Controller_Userguide</a></li>
						</ol>		</li>
			<li><span>Undocumented</span>
			<ol>							<li><a href="Kodoc_Missing.html">Kodoc_Missing</a></li>
						</ol>		</li>
		</ol>
<li><span><strong>[Unknown]</strong></span>
	<ol>
			<li>							<li><a href="Minion_CLI.html">Minion_CLI</a></li>
							<li><a href="Minion_Task.html">Minion_Task</a></li>
							<li><a href="Unittest_Helpers.html">Unittest_Helpers</a></li>
							<li><a href="Unittest_TestCase.html">Unittest_TestCase</a></li>
							<li><a href="Unittest_TestSuite.html">Unittest_TestSuite</a></li>
								</li>
		</ol>
</ol>					</div>
				</div>
				<div id="kodoc-body" class="span-16 suffix-1 last">
					<h1>
	Kohana_Request_Client_Stream		<br/><small>extends <a href="Request_Client_External.html">Request_Client_External</a></small>
		<br/><small>extends <a href="Kohana_Request_Client_External.html">Kohana_Request_Client_External</a></small>
		<br/><small>extends <a href="Request_Client.html">Request_Client</a></small>
		<br/><small>extends <a href="Kohana_Request_Client.html">Kohana_Request_Client</a></small>
	</h1>


<p class="note">
This class is a transparent base class for <a href="Request_Client_Stream.html">Request_Client_Stream</a> and
should not be accessed directly.
</p>

<p><a href="Request_Client_External.html">Request_Client_External</a> Stream driver performs external requests using php
sockets. To use this driver, ensure the following is completed
before executing an external request- ideally in the application bootstrap.</p>

<dl class="tags">
<dt>example</dt>
<dd>

      // In application bootstrap
      Request_Client_External::$client = 'Request_Client_Stream';
</dd>
<dt>package</dt>
<dd>Kohana</dd>
<dt>category</dt>
<dd>Base</dd>
<dt>author</dt>
<dd>Kohana Team</dd>
<dt>copyright</dt>
<dd>&copy; 2008-2012 Kohana Team</dd>
<dt>license</dt>
<dd><a href="http://kohanaframework.org/license">http://kohanaframework.org/license</a></dd>
<dt>uses</dt>
<dd>[PHP Streams](http://php.net/manual/en/book.stream.php)</dd>
</dl>

<p class="note">
Class declared in <tt>SYSPATH/classes/Kohana/Request/Client/Stream.php</tt> on line 19.
</p>

<div class="toc">
	<div class="constants">
		<h3>Constants</h3>
		<ul>
					<li><em>None</em></li>
				</ul>
	</div>
	<div class="properties">
		<h3>Properties</h3>
		<ul>
							<li><a href="Kohana_Request_Client_Stream.html#property:client">$client</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_cache">$_cache</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_callback_depth">$_callback_depth</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_callback_params">$_callback_params</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_follow">$_follow</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_follow_headers">$_follow_headers</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_header_callbacks">$_header_callbacks</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_max_callback_depth">$_max_callback_depth</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_options">$_options</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#property:_strict_redirect">$_strict_redirect</a></li>
						</ul>
	</div>
	<div class="methods">
		<h3>Methods</h3>
		<ul>
							<li><a href="Kohana_Request_Client_Stream.html#_send_message">_send_message()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#execute_request">execute_request()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#factory">factory()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#options">options()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#__construct">__construct()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#assign_client_properties">assign_client_properties()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#cache">cache()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#callback_depth">callback_depth()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#callback_params">callback_params()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#execute">execute()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#follow">follow()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#follow_headers">follow_headers()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#header_callbacks">header_callbacks()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#max_callback_depth">max_callback_depth()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#on_header_location">on_header_location()</a></li>
					<li><a href="Kohana_Request_Client_Stream.html#strict_redirect">strict_redirect()</a></li>
						</ul>
	</div>
</div>

<div class="clearfix"></div>


<h1 id="properties">Properties</h1>
<div class="properties">
<dl>
<dt><h4 id="property:client"><small>public static</small>  <code>string</code> $client</h4></dt>
<dd><p>defines the external client to use by default</p>
</dd>
<dd><pre class="debug"><small>string</small><span>(19)</span> "Request_Client_Curl"</pre></dd>
<dt><h4 id="property:_cache"><small>protected</small>  <code>Cache</code> $_cache</h4></dt>
<dd><p>Caching library for request caching</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>NULL</small></pre></dd>
<dt><h4 id="property:_callback_depth"><small>protected</small>  <code>int</code> $_callback_depth</h4></dt>
<dd><p>Tracks the callback depth of the currently executing request</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>integer</small> 1</pre></dd>
<dt><h4 id="property:_callback_params"><small>protected</small>  <code>array</code> $_callback_params</h4></dt>
<dd><p>Arbitrary parameters that are shared with header callbacks through their Request_Client object</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>array</small><span>(0)</span> </pre></dd>
<dt><h4 id="property:_follow"><small>protected</small>  <code>bool</code> $_follow</h4></dt>
<dd><p>Should redirects be followed?</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>bool</small> FALSE</pre></dd>
<dt><h4 id="property:_follow_headers"><small>protected</small>  <code>array</code> $_follow_headers</h4></dt>
<dd><p>Headers to preserve when following a redirect</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>array</small><span>(1)</span> <span>(
    0 => <small>string</small><span>(13)</span> "Authorization"
)</span></pre></dd>
<dt><h4 id="property:_header_callbacks"><small>protected</small>  <code>array</code> $_header_callbacks</h4></dt>
<dd><p>Callbacks to use when response contains given headers</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>array</small><span>(1)</span> <span>(
    "Location" => <small>string</small><span>(34)</span> "Request_Client::on_header_location"
)</span></pre></dd>
<dt><h4 id="property:_max_callback_depth"><small>protected</small>  <code>int</code> $_max_callback_depth</h4></dt>
<dd><p>Maximum number of requests that header callbacks can trigger before the request is aborted</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>integer</small> 5</pre></dd>
<dt><h4 id="property:_options"><small>protected</small>  <code>array</code> $_options</h4></dt>
<dd><p>curl options</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>array</small><span>(0)</span> </pre></dd>
<dt><h4 id="property:_strict_redirect"><small>protected</small>  <code>bool</code> $_strict_redirect</h4></dt>
<dd><p>Follow 302 redirect with original request method?</p>
</dd>
<dd></dd>
<dd><small>Default value:</small><br/><pre class="debug"><small>bool</small> TRUE</pre></dd>
</dl>
</div>

<h1 id="methods">Methods</h1>
<div class="methods">
<div class="method">

<h3 id="_send_message">
	<small>public</small> _send_message( <small>Request</small> <span class="param" title="Request to send">$request</span> , <small>Response</small> <span class="param" title="$request response to send">$response</span> )
	<small>(defined in <a href="Kohana_Request_Client_Stream.html">Kohana_Request_Client_Stream</a>)</small>
</h3>

<div class="description">
<p>Sends the HTTP message <a href="Request.html">Request</a> to a remote server and processes
the response.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>Request</code>
<strong>$request</strong>
<small>required</small> - Request to send</li>
<li>
<code>Response</code>
<strong>$response</strong>
<small>required</small> - $request  response to send</li>
</ul>

<h4>Tags</h4>
<ul class="tags">
<li>Uses - [PHP cURL](http://php.net/manual/en/book.curl.php)</ul>
<h4>Return Values</h4>
<ul class="return">
<li><code>Response</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function _send_message(Request $request, Response $response)
{
	// Calculate stream mode
	$mode = ($request-&gt;method() === HTTP_Request::GET) ? &#039;r&#039; : &#039;r+&#039;;

	// Process cookies
	if ($cookies = $request-&gt;cookie())
	{
		$request-&gt;headers(&#039;cookie&#039;, http_build_query($cookies, NULL, &#039;; &#039;));
	}

	// Get the message body
	$body = $request-&gt;body();

	if (is_resource($body))
	{
		$body = stream_get_contents($body);
	}

	// Set the content length
	$request-&gt;headers(&#039;content-length&#039;, (string) strlen($body));

	list($protocol) = explode(&#039;/&#039;, $request-&gt;protocol());

	// Create the context
	$options = array(
		strtolower($protocol) =&gt; array(
			&#039;method&#039;     =&gt; $request-&gt;method(),
			&#039;header&#039;     =&gt; (string) $request-&gt;headers(),
			&#039;content&#039;    =&gt; $body
		)
	);

	// Create the context stream
	$context = stream_context_create($options);

	stream_context_set_option($context, $this-&gt;_options);

	$uri = $request-&gt;uri();

	if ($query = $request-&gt;query())
	{
		$uri .= &#039;?&#039;.http_build_query($query, NULL, &#039;&amp;&#039;);
	}

	$stream = fopen($uri, $mode, FALSE, $context);

	$meta_data = stream_get_meta_data($stream);

	// Get the HTTP response code
	$http_response = array_shift($meta_data[&#039;wrapper_data&#039;]);

	if (preg_match_all(&#039;/(\w+\/\d\.\d) (\d{3})/&#039;, $http_response, $matches) !== FALSE)
	{
		$protocol = $matches[1][0];
		$status   = (int) $matches[2][0];
	}
	else
	{
		$protocol = NULL;
		$status   = NULL;
	}

	// Get any exisiting response headers
	$response_header = $response-&gt;headers();

	// Process headers
	array_map(array($response_header, &#039;parse_header_string&#039;), array(), $meta_data[&#039;wrapper_data&#039;]);

	$response-&gt;status($status)
		-&gt;protocol($protocol)
		-&gt;body(stream_get_contents($stream));

	// Close the stream after use
	fclose($stream);

	return $response;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="execute_request">
	<small>public</small> execute_request( <small>Request</small> <span class="param" title="A request object">$request</span> , <small>Response</small> <span class="param" title="A response object">$response</span> )
	<small>(defined in <a href="Kohana_Request_Client_External.html">Kohana_Request_Client_External</a>)</small>
</h3>

<div class="description">
<p>Processes the request, executing the controller action that handles this
request, determined by the <a href="Route.html">Route</a>.</p>

<ol>
<li>Before the controller action is called, the <a href="Controller.html#before">Controller::before</a> method
will be called.</li>
<li>Next the controller action will be called.</li>
<li>After the controller action is called, the <a href="Controller.html#after">Controller::after</a> method
will be called.</li>
</ol>

<p>By default, the output from the controller is captured and returned, and
no headers are sent.</p>

<pre><code>$request-&gt;execute();
</code></pre>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>Request</code>
<strong>$request</strong>
<small>required</small> - A request object</li>
<li>
<code>Response</code>
<strong>$response</strong>
<small>required</small> - A response object</li>
</ul>

<h4>Tags</h4>
<ul class="tags">
<li>Throws - <a href="Kohana_Exception.html">Kohana_Exception</a><li>Uses - [Kohana::$profiling], [Profiler]</ul>
<h4>Return Values</h4>
<ul class="return">
<li><code>Response</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function execute_request(Request $request, Response $response)
{
	if (Kohana::$profiling)
	{
		// Set the benchmark name
		$benchmark = &#039;&quot;&#039;.$request-&gt;uri().&#039;&quot;&#039;;

		if ($request !== Request::$initial AND Request::$current)
		{
			// Add the parent request uri
			$benchmark .= &#039; Â« &quot;&#039;.Request::$current-&gt;uri().&#039;&quot;&#039;;
		}

		// Start benchmarking
		$benchmark = Profiler::start(&#039;Requests&#039;, $benchmark);
	}

	// Store the current active request and replace current with new request
	$previous = Request::$current;
	Request::$current = $request;

	// Resolve the POST fields
	if ($post = $request-&gt;post())
	{
		$request-&gt;body(http_build_query($post, NULL, &#039;&amp;&#039;))
			-&gt;headers(&#039;content-type&#039;, &#039;application/x-www-form-urlencoded; charset=&#039;.Kohana::$charset);
	}

	// If Kohana expose, set the user-agent
	if (Kohana::$expose)
	{
		$request-&gt;headers(&#039;user-agent&#039;, Kohana::version());
	}

	try
	{
		$response = $this-&gt;_send_message($request, $response);
	}
	catch (Exception $e)
	{
		// Restore the previous request
		Request::$current = $previous;

		if (isset($benchmark))
		{
			// Delete the benchmark, it is invalid
			Profiler::delete($benchmark);
		}

		// Re-throw the exception
		throw $e;
	}

	// Restore the previous request
	Request::$current = $previous;

	if (isset($benchmark))
	{
		// Stop the benchmark
		Profiler::stop($benchmark);
	}

	// Return the response
	return $response;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="factory">
	<small>public static</small> factory( [ <small>array</small> <span class="param" title="Parameters to pass to the client">$params</span> <small>= <small>array</small><span>(0)</span> </small> , <small>string</small> <span class="param" title="External client to use">$client</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client_External.html">Kohana_Request_Client_External</a>)</small>
</h3>

<div class="description">
<p>Factory method to create a new Request_Client_External object based on
the client name passed, or defaulting to Request_Client_External::$client
by default.</p>

<p>Request_Client_External::$client can be set in the application bootstrap.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>array</code>
<strong>$params</strong>
<small> = <small>array</small><span>(0)</span> </small> - Parameters to pass to the client</li>
<li>
<code>string</code>
<strong>$client</strong>
<small> = <small>NULL</small></small> - External client to use</li>
</ul>

<h4>Tags</h4>
<ul class="tags">
<li>Throws - <a href="Request_Exception.html">Request_Exception</a></ul>
<h4>Return Values</h4>
<ul class="return">
<li><code>Request_Client_External</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public static function factory(array $params = array(), $client = NULL)
{
	if ($client === NULL)
	{
		$client = Request_Client_External::$client;
	}

	$client = new $client($params);

	if ( ! $client instanceof Request_Client_External)
	{
		throw new Request_Exception(&#039;Selected client is not a Request_Client_External object.&#039;);
	}

	return $client;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="options">
	<small>public</small> options( [ <small>mixed</small> <span class="param" title="Option name, or array of options">$key</span> <small>= <small>NULL</small></small> , <small>mixed</small> <span class="param" title="Option value">$value</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client_External.html">Kohana_Request_Client_External</a>)</small>
</h3>

<div class="description">
<p>Set and get options for this request.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>mixed</code>
<strong>$key</strong>
<small> = <small>NULL</small></small> - Option name, or array of options</li>
<li>
<code>mixed</code>
<strong>$value</strong>
<small> = <small>NULL</small></small> - Option value</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>mixed</code></li>
<li><code>Request_Client_External</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function options($key = NULL, $value = NULL)
{
	if ($key === NULL)
		return $this-&gt;_options;

	if (is_array($key))
	{
		$this-&gt;_options = $key;
	}
	elseif ($value === NULL)
	{
		return Arr::get($this-&gt;_options, $key);
	}
	else
	{
		$this-&gt;_options[$key] = $value;
	}

	return $this;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="__construct">
	<small>public</small> __construct( [ <small>array</small> <span class="param" title="Params">$params</span> <small>= <small>array</small><span>(0)</span> </small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Creates a new <code>Request_Client</code> object,
allows for dependency injection.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>array</code>
<strong>$params</strong>
<small> = <small>array</small><span>(0)</span> </small> - Params</li>
</ul>



<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function __construct(array $params = array())
{
	foreach ($params as $key =&gt; $value)
	{
		if (method_exists($this, $key))
		{
			$this-&gt;$key($value);
		}
	}
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="assign_client_properties">
	<small>public</small> assign_client_properties( <small>Request_Client</small> <span class="param" title="$client">$client</span> )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Assigns the properties of the current Request_Client to another
Request_Client instance - used when setting up a subsequent request.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>Request_Client</code>
<strong>$client</strong>
<small>required</small> - $client</li>
</ul>



<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function assign_client_properties(Request_Client $client)
{
	$client-&gt;cache($this-&gt;cache());
	$client-&gt;follow($this-&gt;follow());
	$client-&gt;follow_headers($this-&gt;follow_headers());
	$client-&gt;header_callbacks($this-&gt;header_callbacks());
	$client-&gt;max_callback_depth($this-&gt;max_callback_depth());
	$client-&gt;callback_params($this-&gt;callback_params());
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="cache">
	<small>public</small> cache( [ <small>HTTP_Cache</small> <span class="param" title="Engine to use for caching">$cache</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter and setter for the internal caching engine,
used to cache responses if available and valid.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>HTTP_Cache</code>
<strong>$cache</strong>
<small> = <small>NULL</small></small> - Engine to use for caching</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>HTTP_Cache</code></li>
<li><code>Request_Client</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function cache(HTTP_Cache $cache = NULL)
{
	if ($cache === NULL)
		return $this-&gt;_cache;

	$this-&gt;_cache = $cache;
	return $this;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="callback_depth">
	<small>public</small> callback_depth( [ <small>int</small> <span class="param" title="Current recursion depth">$depth</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter/Setter for the callback depth property, which is used to track
how many recursions have been executed within the current request execution.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>int</code>
<strong>$depth</strong>
<small> = <small>NULL</small></small> - Current recursion depth</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>Request_Client|int</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function callback_depth($depth = NULL)
{
	if ($depth === NULL)
		return $this-&gt;_callback_depth;

	$this-&gt;_callback_depth = $depth;

	return $this;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="callback_params">
	<small>public</small> callback_params( [ <small>string|array</small> <span class="param" title="$param">$param</span> <small>= <small>NULL</small></small> , <small>mixed</small> <span class="param" title="$value">$value</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter/Setter for the callback_params array, which allows additional
application-specific parameters to be shared with callbacks.</p>

<p>As with other Kohana setter/getters, usage is:</p>

<pre><code>// Set full array
$client-&gt;callback_params(array('foo'=&gt;'bar'));

// Set single key
$client-&gt;callback_params('foo','bar');

// Get full array
$params = $client-&gt;callback_params();

// Get single key
$foo = $client-&gt;callback_params('foo');
</code></pre>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>string|array</code>
<strong>$param</strong>
<small> = <small>NULL</small></small> - $param</li>
<li>
<code>mixed</code>
<strong>$value</strong>
<small> = <small>NULL</small></small> - $value</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>Request_Client|mixed</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function callback_params($param = NULL, $value = NULL)
{
	// Getter for full array
	if ($param === NULL)
		return $this-&gt;_callback_params;

	// Setter for full array
	if (is_array($param))
	{
		$this-&gt;_callback_params = $param;
		return $this;
	}
	// Getter for single value
	elseif ($value === NULL)
	{
		return Arr::get($this-&gt;_callback_params, $param);
	}
	// Setter for single value
	else
	{
		$this-&gt;_callback_params[$param] = $value;
		return $this;
	}

}</code></pre>
</div>

</div>
<div class="method">

<h3 id="execute">
	<small>public</small> execute( <small>Request</small> <span class="param" title="$request">$request</span> )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Processes the request, executing the controller action that handles this
request, determined by the <a href="Route.html">Route</a>.</p>

<ol>
<li>Before the controller action is called, the <a href="Controller.html#before">Controller::before</a> method
will be called.</li>
<li>Next the controller action will be called.</li>
<li>After the controller action is called, the <a href="Controller.html#after">Controller::after</a> method
will be called.</li>
</ol>

<p>By default, the output from the controller is captured and returned, and
no headers are sent.</p>

<pre><code>$request-&gt;execute();
</code></pre>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>Request</code>
<strong>$request</strong>
<small>required</small> - $request</li>
</ul>

<h4>Tags</h4>
<ul class="tags">
<li>Throws - <a href="Kohana_Exception.html">Kohana_Exception</a><li>Uses - [Kohana::$profiling], [Profiler]</ul>
<h4>Return Values</h4>
<ul class="return">
<li><code>Response</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function execute(Request $request)
{
	// Prevent too much recursion of header callback requests
	if ($this-&gt;callback_depth() &gt; $this-&gt;max_callback_depth())
		throw new Request_Client_Recursion_Exception(
				&quot;Could not execute request to :uri - too many recursions after :depth requests&quot;,
				array(
					&#039;:uri&#039; =&gt; $request-&gt;uri(),
					&#039;:depth&#039; =&gt; $this-&gt;callback_depth() - 1,
				));

	// Execute the request and pass the currently used protocol
	$orig_response = $response = Response::factory(array(&#039;_protocol&#039; =&gt; $request-&gt;protocol()));

	if (($cache = $this-&gt;cache()) instanceof HTTP_Cache)
		return $cache-&gt;execute($this, $request, $response);

	$response = $this-&gt;execute_request($request, $response);

	// Execute response callbacks
	foreach ($this-&gt;header_callbacks() as $header =&gt; $callback)
	{
		if ($response-&gt;headers($header))
		{
			$cb_result = call_user_func($callback, $request, $response, $this);

			if ($cb_result instanceof Request)
			{
				// If the callback returns a request, automatically assign client params
				$this-&gt;assign_client_properties($cb_result-&gt;client());
				$cb_result-&gt;client()-&gt;callback_depth($this-&gt;callback_depth() + 1);

				// Execute the request
				$response = $cb_result-&gt;execute();
			}
			elseif ($cb_result instanceof Response)
			{
				// Assign the returned response
				$response = $cb_result;
			}

			// If the callback has created a new response, do not process any further
			if ($response !== $orig_response)
				break;
		}
	}

	return $response;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="follow">
	<small>public</small> follow( [ <small>bool</small> <span class="param" title="Boolean indicating if redirects should be followed">$follow</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter and setter for the follow redirects
setting.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>bool</code>
<strong>$follow</strong>
<small> = <small>NULL</small></small> - Boolean indicating if redirects should be followed</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>bool</code></li>
<li><code>Request_Client</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function follow($follow = NULL)
{
	if ($follow === NULL)
		return $this-&gt;_follow;

	$this-&gt;_follow = $follow;

	return $this;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="follow_headers">
	<small>public</small> follow_headers( [ <small>array</small> <span class="param" title="Array of headers to be re-used when following a Location header">$follow_headers</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter and setter for the follow redirects
headers array.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>array</code>
<strong>$follow_headers</strong>
<small> = <small>NULL</small></small> - Array of headers to be re-used when following a Location header</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>array</code></li>
<li><code>Request_Client</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function follow_headers($follow_headers = NULL)
{
	if ($follow_headers === NULL)
		return $this-&gt;_follow_headers;

	$this-&gt;_follow_headers = $follow_headers;

	return $this;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="header_callbacks">
	<small>public</small> header_callbacks( [ <small>array</small> <span class="param" title="Array of callbacks to trigger on presence of given headers">$header_callbacks</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter and setter for the header callbacks array.</p>

<p>Accepts an array with HTTP response headers as keys and a PHP callback
function as values. These callbacks will be triggered if a response contains
the given header and can either issue a subsequent request or manipulate
the response as required.</p>

<p>By default, the <a href="Request_Client.html#on_header_location">Request_Client::on_header_location</a> callback is assigned
to the Location header to support automatic redirect following.</p>

<pre><code>$client-&gt;header_callbacks(array(
    'Location' =&gt; 'Request_Client::on_header_location',
    'WWW-Authenticate' =&gt; function($request, $response, $client) {return $new_response;},
);
</code></pre>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>array</code>
<strong>$header_callbacks</strong>
<small> = <small>NULL</small></small> - Array of callbacks to trigger on presence of given headers</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>Request_Client</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function header_callbacks($header_callbacks = NULL)
{
	if ($header_callbacks === NULL)
		return $this-&gt;_header_callbacks;

	$this-&gt;_header_callbacks = $header_callbacks;

	return $this;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="max_callback_depth">
	<small>public</small> max_callback_depth( [ <small>int</small> <span class="param" title="Maximum number of callback requests to execute before aborting">$depth</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter and setter for the maximum callback depth property.</p>

<p>This protects the main execution from recursive callback execution (eg
following infinite redirects, conflicts between callbacks causing loops
etc). Requests will only be allowed to nest to the level set by this
param before execution is aborted with a Request_Client_Recursion_Exception.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>int</code>
<strong>$depth</strong>
<small> = <small>NULL</small></small> - Maximum number of callback requests to execute before aborting</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>Request_Client|int</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function max_callback_depth($depth = NULL)
{
	if ($depth === NULL)
		return $this-&gt;_max_callback_depth;

	$this-&gt;_max_callback_depth = $depth;

	return $this;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="on_header_location">
	<small>public static</small> on_header_location( <small>Request</small> <span class="param" title="$request">$request</span> , <small>Response</small> <span class="param" title="$response">$response</span> , <small>Request_Client</small> <span class="param" title="$client">$client</span> )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>The default handler for following redirects, triggered by the presence of
a Location header in the response.</p>

<p>The client's follow property must be set TRUE and the HTTP response status
one of 201, 301, 302, 303 or 307 for the redirect to be followed.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>Request</code>
<strong>$request</strong>
<small>required</small> - $request</li>
<li>
<code>Response</code>
<strong>$response</strong>
<small>required</small> - $response</li>
<li>
<code>Request_Client</code>
<strong>$client</strong>
<small>required</small> - $client</li>
</ul>



<div class="method-source">
<h4>Source Code</h4>
<pre><code>public static function on_header_location(Request $request, Response $response, Request_Client $client)
{
	// Do we need to follow a Location header ?
	if ($client-&gt;follow() AND in_array($response-&gt;status(), array(201, 301, 302, 303, 307)))
	{
		// Figure out which method to use for the follow request
		switch ($response-&gt;status())
		{
			default:
			case 301:
			case 307:
				$follow_method = $request-&gt;method();
				break;
			case 201:
			case 303:
				$follow_method = Request::GET;
				break;
			case 302:
				// Cater for sites with broken HTTP redirect implementations
				if ($client-&gt;strict_redirect())
				{
					$follow_method = $request-&gt;method();
				}
				else
				{
					$follow_method = Request::GET;
				}
				break;
		}

		// Prepare the additional request
		$follow_request = Request::factory($response-&gt;headers(&#039;Location&#039;))
		                         -&gt;method($follow_method)
		                         -&gt;headers(Arr::extract($request-&gt;headers(), $client-&gt;follow_headers()));

		if ($follow_method !== Request::GET)
		{
			$follow_request-&gt;body($request-&gt;body());
		}

		return $follow_request;
	}

	return NULL;
}</code></pre>
</div>

</div>
<div class="method">

<h3 id="strict_redirect">
	<small>public</small> strict_redirect( [ <small>bool</small> <span class="param" title="Boolean indicating if 302 redirects should be followed with the original method">$strict_redirect</span> <small>= <small>NULL</small></small> ] )
	<small>(defined in <a href="Kohana_Request_Client.html">Kohana_Request_Client</a>)</small>
</h3>

<div class="description">
<p>Getter and setter for the strict redirects setting</p>

<p class="note">HTTP/1.1 specifies that a 302 redirect should be followed using the
original request method. However, the vast majority of clients and servers
get this wrong, with 302 widely used for 'POST - 302 redirect - GET' patterns.
By default, Kohana's client is fully compliant with the HTTP spec. Some
non-compliant third party sites may require that strict_redirect is set
FALSE to force the client to switch to GET following a 302 response.</p>
</div>

<h4>Parameters</h4>
<ul>
<li>
<code>bool</code>
<strong>$strict_redirect</strong>
<small> = <small>NULL</small></small> - Boolean indicating if 302 redirects should be followed with the original method</li>
</ul>


<h4>Return Values</h4>
<ul class="return">
<li><code>Request_Client</code></li>
</ul>

<div class="method-source">
<h4>Source Code</h4>
<pre><code>public function strict_redirect($strict_redirect = NULL)
{
	if ($strict_redirect === NULL)
		return $this-&gt;_strict_redirect;

	$this-&gt;_strict_redirect = $strict_redirect;

	return $this;
}</code></pre>
</div>

</div>
</div>

									</div>
			</div>
		</div>
	</div>

	<div id="kodoc-footer">
		<div class="container">
			<div class="span-12">
							&nbsp;
						</div>
			<div class="span-12 last right">
			<p>Powered by <a href="http://kohanaframework.org/">Kohana</a> v3.3.1</p>
			</div>
		</div>
	</div>

</body>
</html>
